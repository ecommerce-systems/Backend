@startuml
start
:관리자 상품 등록 요청;
:DTO 수신 (이름, 가격, 카테고리명 등);

partition "카테고리 해결 (Resolve Categories)" {
  :ProductType 이름으로 조회;
  if (존재하지 않음?) then (Yes)
    :새 ProductType 생성 및 저장;
  endif
  :...(다른 카테고리들도 동일하게 처리);
}

:Product 엔티티 빌드;
:DB(products)에 저장;

partition "V2 데이터 동기화 (Sync)" {
  :Product 정보를 기반으로 ProductSearch 엔티티 빌드;
  :모든 카테고리 이름을 문자열로 평탄화(Denormalize);
  :DB(product_searches)에 저장;
}

:등록 완료 응답;
stop
@enduml
